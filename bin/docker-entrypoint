#!/bin/bash -e

# Remove pre-existing server.pid if it exists
if [ -f tmp/pids/server.pid ]; then
  rm tmp/pids/server.pid
fi

## Wait for database to be ready
#until pg_isready -h db -U postgres; do
#  echo "Waiting for database to be ready..."
#  sleep 2
#done

# Create database if it doesn't exist
bundle exec rails db:prepare

# Execute the main process
exec "$@"
